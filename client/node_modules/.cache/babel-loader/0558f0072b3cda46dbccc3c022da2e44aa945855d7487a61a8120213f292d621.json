{"ast":null,"code":"require(\"dotenv\").config();\nconst express = require(\"express\");\nconst cors = require(\"cors\");\nconst bodyParser = require(\"body-parser\");\nconst axios = require(\"axios\");\nconst authRoutes = require(\"./routes/auth\");\nconst healthProgramRoutes = require(\"./routes/healthPrograms\");\nconst evenementRoutes = require(\"./routes/evenementRoutes\");\nconst articleRoutes = require(\"./routes/articleRoutes\");\nconst aiRoutes = require(\"./routes/aiRoutes\");\nconst aiarticleRoutes = require(\"./routes/ai-articles\");\nconst aienhancedRoutes = require(\"./routes/ai-enhanced\");\nconst app = express();\n\n// âœ… Middleware\napp.use(cors());\napp.use(bodyParser.json());\n\n// âœ… Routes\napp.use(\"/api/auth\", authRoutes);\napp.use(\"/api/health-programs\", healthProgramRoutes);\napp.use(\"/api/evenements\", evenementRoutes);\napp.use(\"/api/articles\", articleRoutes);\napp.use(\"/ai\", aiRoutes);\napp.use(\"/aiarticle\", aiarticleRoutes);\napp.use(\"/aienhanced\", aienhancedRoutes);\n\n// âœ… AI Content Generation Function\nconst generateArticleContent = async function (topic) {\n  let type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"Standard\";\n  let tone = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"professional\";\n  try {\n    console.log(\"\\uD83E\\uDD16 Generating content for topic: \".concat(topic, \", type: \").concat(type, \", tone: \").concat(tone));\n    const titles = {\n      \"Premium\": \"Analyse Exclusive: \".concat(topic, \" - Perspectives Avanc\\xE9es\"),\n      \"Standard\": \"\\xC9tude Approfondie: \".concat(topic, \" - Tendances et Analyses\"),\n      \"Basique\": \"Guide Pratique: Comprendre \".concat(topic)\n    };\n    const descriptions = {\n      \"Premium\": \"Article premium g\\xE9n\\xE9r\\xE9 automatiquement offrant une analyse compl\\xE8te de \\\"\".concat(topic, \"\\\" avec insights exclusifs et donn\\xE9es r\\xE9centes.\"),\n      \"Standard\": \"Contenu g\\xE9n\\xE9r\\xE9 automatiquement explorant les aspects cl\\xE9s de \\\"\".concat(topic, \"\\\" avec analyse structur\\xE9e et recommandations.\"),\n      \"Basique\": \"Introduction claire et concise sur \\\"\".concat(topic, \"\\\" g\\xE9n\\xE9r\\xE9e automatiquement pour une compr\\xE9hension rapide.\")\n    };\n    return {\n      title: titles[type] || titles[\"Standard\"],\n      description: descriptions[type] || descriptions[\"Standard\"],\n      content: \"# \".concat(topic, \"\\n\\n## Introduction\\nCet article a \\xE9t\\xE9 g\\xE9n\\xE9r\\xE9 automatiquement pour explorer le th\\xE8me \\\"\").concat(topic, \"\\\".\\n\\n## Points Cl\\xE9s\\n- Aspect important 1\\n- Aspect important 2  \\n- Perspective future\\n\\n## Conclusion\\nAnalyse synth\\xE9tique g\\xE9n\\xE9r\\xE9e par IA.\"),\n      generated_at: new Date().toISOString(),\n      word_count: Math.floor(Math.random() * 200) + 300\n    };\n  } catch (error) {\n    console.error(\"âŒ Error generating article content:\", error);\n    throw new Error(\"Erreur lors de la gÃ©nÃ©ration du contenu\");\n  }\n};\n\n// âœ… AI Event Attendance Prediction Function\nconst predictAttendance = async function (eventDetails) {\n  let historicalData = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  try {\n    console.log(\"ðŸ¤– Predicting attendance for event:\", eventDetails);\n    let basePrediction = 100;\n    const factors = [];\n    const locationMultipliers = {\n      'Paris': 1.5,\n      'Lyon': 1.2,\n      'Marseille': 1.1,\n      'Londres': 1.4,\n      'New York': 1.6,\n      'Tokyo': 1.3\n    };\n    if (eventDetails.location && locationMultipliers[eventDetails.location]) {\n      basePrediction *= locationMultipliers[eventDetails.location];\n      factors.push(\"Localisation: \".concat(eventDetails.location));\n    }\n    const statusMultipliers = {\n      'PlanifiÃ©': 1.0,\n      'En cours': 1.2,\n      'TerminÃ©': 0.8,\n      'AnnulÃ©': 0.1\n    };\n    if (eventDetails.status && statusMultipliers[eventDetails.status]) {\n      basePrediction *= statusMultipliers[eventDetails.status];\n      factors.push(\"Statut: \".concat(eventDetails.status));\n    }\n    const currentMonth = new Date().getMonth() + 1;\n    const seasonMultipliers = {\n      12: 1.3,\n      1: 1.1,\n      6: 1.2,\n      9: 1.4\n    };\n    if (seasonMultipliers[currentMonth]) {\n      basePrediction *= seasonMultipliers[currentMonth];\n      factors.push(\"Saison: Mois \".concat(currentMonth));\n    }\n    if (historicalData.length > 0) {\n      const avgHistorical = historicalData.reduce((sum, event) => sum + event.attendance, 0) / historicalData.length;\n      const historicalAdjustment = avgHistorical / 100;\n      basePrediction = (basePrediction + historicalAdjustment * 50) / 2;\n      factors.push(\"Donn\\xE9es historiques: \".concat(historicalData.length, \" \\xE9v\\xE9nements\"));\n    }\n    const randomVariation = Math.random() * 40 - 20;\n    basePrediction *= 1 + randomVariation / 100;\n    basePrediction = Math.max(10, Math.min(500, Math.round(basePrediction)));\n    let confidence = 0.7;\n    if (historicalData.length > 5) confidence += 0.2;\n    if (eventDetails.location && eventDetails.status) confidence += 0.1;\n    confidence = Math.min(0.95, confidence);\n    return {\n      predictedAttendance: Math.round(basePrediction),\n      confidence: parseFloat(confidence.toFixed(2)),\n      factors: factors.length > 0 ? factors : [\"DonnÃ©es de base\"],\n      prediction_date: new Date().toISOString(),\n      recommendation: basePrediction > 200 ? \"Ã‰vÃ©nement Ã  fort potentiel\" : \"Participation standard attendue\"\n    };\n  } catch (error) {\n    console.error(\"âŒ Error predicting attendance:\", error);\n    throw new Error(\"Erreur lors de la prÃ©diction de participation\");\n  }\n};\n\n// âœ… Enhanced Mock AI service\nconst mockAIResponse = function (question) {\n  let context = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const lowerQuestion = question.toLowerCase();\n  const {\n    currentEvents = [],\n    totalEvents = 0,\n    currentArticles = [],\n    totalArticles = 0\n  } = context;\n\n  // Article Content Generation\n  if (lowerQuestion.includes('gÃ©nÃ©rer') && (lowerQuestion.includes('article') || lowerQuestion.includes('contenu'))) {\n    const topicMatch = question.match(/(?:article|contenu|gÃ©nÃ©rer)\\s+(?:sur|about|de)\\s+([^,.!?]+)/i);\n    const topic = topicMatch ? topicMatch[1].trim() : 'technologie';\n    return {\n      action: 'generate_content',\n      natural_response: \"Je vais g\\xE9n\\xE9rer un article automatiquement sur le th\\xE8me \\\"\".concat(topic, \"\\\".\"),\n      data: {\n        topic: topic,\n        type: 'Standard',\n        tone: 'professional'\n      },\n      confidence: 0.9\n    };\n  }\n\n  // Attendance Prediction\n  if ((lowerQuestion.includes('participation') || lowerQuestion.includes('attendance') || lowerQuestion.includes('frÃ©quentation')) && (lowerQuestion.includes('prÃ©dire') || lowerQuestion.includes('predict') || lowerQuestion.includes('estimer'))) {\n    return {\n      action: 'predict_attendance',\n      natural_response: \"Je vais analyser et prÃ©dire la participation aux Ã©vÃ©nements.\",\n      data: {\n        analyze_all: true\n      },\n      confidence: 0.8\n    };\n  }\n\n  // Existing event status queries...\n  if (lowerQuestion.includes('planifiÃ©') || lowerQuestion.includes('planifie')) {\n    const plannedEvents = currentEvents.filter(e => e.status === 'PlanifiÃ©');\n    return {\n      action: 'read',\n      natural_response: \"J'ai trouv\\xE9 \".concat(plannedEvents.length, \" \\xE9v\\xE9nement(s) planifi\\xE9(s) sur \").concat(totalEvents, \" au total.\"),\n      filters: [{\n        field: 'psStatus',\n        operator: '==',\n        value: 'PlanifiÃ©',\n        description: 'Statut: PlanifiÃ©'\n      }],\n      confidence: 0.9\n    };\n  }\n  if (lowerQuestion.includes('en cours')) {\n    const ongoingEvents = currentEvents.filter(e => e.status === 'En cours');\n    return {\n      action: 'read',\n      natural_response: \"J'ai trouv\\xE9 \".concat(ongoingEvents.length, \" \\xE9v\\xE9nement(s) en cours sur \").concat(totalEvents, \" au total.\"),\n      filters: [{\n        field: 'psStatus',\n        operator: '==',\n        value: 'En cours',\n        description: 'Statut: En cours'\n      }],\n      confidence: 0.9\n    };\n  }\n  if (lowerQuestion.includes('terminÃ©') || lowerQuestion.includes('termine')) {\n    const completedEvents = currentEvents.filter(e => e.status === 'TerminÃ©');\n    return {\n      action: 'read',\n      natural_response: \"J'ai trouv\\xE9 \".concat(completedEvents.length, \" \\xE9v\\xE9nement(s) termin\\xE9(s) sur \").concat(totalEvents, \" au total.\"),\n      filters: [{\n        field: 'psStatus',\n        operator: '==',\n        value: 'TerminÃ©',\n        description: 'Statut: TerminÃ©'\n      }],\n      confidence: 0.9\n    };\n  }\n  if (lowerQuestion.includes('annulÃ©') || lowerQuestion.includes('annule')) {\n    const cancelledEvents = currentEvents.filter(e => e.status === 'AnnulÃ©');\n    return {\n      action: 'read',\n      natural_response: \"J'ai trouv\\xE9 \".concat(cancelledEvents.length, \" \\xE9v\\xE9nement(s) annul\\xE9(s) sur \").concat(totalEvents, \" au total.\"),\n      filters: [{\n        field: 'psStatus',\n        operator: '==',\n        value: 'AnnulÃ©',\n        description: 'Statut: AnnulÃ©'\n      }],\n      confidence: 0.9\n    };\n  }\n\n  // Location-based queries\n  const locations = ['paris', 'lyon', 'marseille', 'toulouse', 'londres', 'new york', 'tokyo'];\n  const foundLocation = locations.find(loc => lowerQuestion.includes(loc));\n  if (foundLocation) {\n    const locationEvents = currentEvents.filter(e => e.location && e.location.toLowerCase().includes(foundLocation));\n    return {\n      action: 'read',\n      natural_response: \"J'ai trouv\\xE9 \".concat(locationEvents.length, \" \\xE9v\\xE9nement(s) \\xE0 \").concat(foundLocation.charAt(0).toUpperCase() + foundLocation.slice(1), \".\"),\n      filters: [{\n        field: 'aLocalisation',\n        operator: 'contains',\n        value: foundLocation,\n        description: \"Localisation: \".concat(foundLocation)\n      }],\n      confidence: 0.8\n    };\n  }\n\n  // Creation\n  if (lowerQuestion.includes('ajout') || lowerQuestion.includes('crÃ©') || lowerQuestion.includes('nouveau') || lowerQuestion.includes('add')) {\n    return {\n      action: 'create',\n      natural_response: \"J'ai d\\xE9tect\\xE9 que vous voulez cr\\xE9er un nouvel \\xE9v\\xE9nement. Je vais le faire automatiquement!\",\n      data: {\n        aTitle: extractTitle(question),\n        aLocalisation: extractLocation(question),\n        psStatus: 'PlanifiÃ©',\n        psDateDebut: new Date().toISOString().split('T')[0],\n        psDateFin: new Date(Date.now() + 86400000).toISOString().split('T')[0],\n        psDescription: extractDescription(question)\n      },\n      confidence: 0.9\n    };\n  }\n\n  // Default search\n  return {\n    action: 'read',\n    natural_response: \"Voici les \\xE9l\\xE9ments correspondant \\xE0 votre recherche.\",\n    filters: [{\n      field: 'aTitle',\n      operator: 'contains',\n      value: extractSearchTerm(question),\n      description: \"Recherche: \\\"\".concat(extractSearchTerm(question), \"\\\"\")\n    }],\n    confidence: 0.6\n  };\n};\n\n// Helper functions\nconst extractTitle = question => {\n  const matches = question.match(/(?:Ã©vÃ©nement|event|meeting|rÃ©union|confÃ©rence)\\s+([^,.!?]+)/i);\n  return matches ? matches[1].trim() : 'Nouvel Ã‰vÃ©nement';\n};\nconst extractLocation = question => {\n  const locations = ['paris', 'lyon', 'marseille', 'toulouse', 'londres', 'new york', 'tokyo'];\n  const found = locations.find(loc => question.toLowerCase().includes(loc));\n  return found ? found.charAt(0).toUpperCase() + found.slice(1) : 'Non spÃ©cifiÃ©';\n};\nconst extractDescription = question => {\n  return \"\\xC9v\\xE9nement cr\\xE9\\xE9 via commande vocale: \\\"\".concat(question.substring(0, 100), \"\\\"\");\n};\nconst extractSearchTerm = question => {\n  const stopWords = ['affiche', 'montre', 'cherche', 'trouve', 'liste', 'vois', 'donne', 'les', 'des', 'Ã©vÃ©nements', 'events', 'articles'];\n  const words = question.toLowerCase().split(' ');\n  return words.filter(word => !stopWords.includes(word) && word.length > 2).join(' ') || question;\n};\n\n// âœ… NEW AI ENDPOINTS\n\n// Generate Article Content\napp.post(\"/ai/generate-article-content\", async (req, res) => {\n  try {\n    const {\n      topic,\n      type,\n      tone\n    } = req.body;\n    if (!topic) {\n      return res.status(400).json({\n        error: \"Le sujet (topic) est requis\"\n      });\n    }\n    console.log(\"ðŸ¤– Generating article content for:\", {\n      topic,\n      type,\n      tone\n    });\n    try {\n      // Try external AI service first\n      const aiResponse = await axios.post('http://localhost:5001/ai/generate-content', {\n        topic,\n        type: type || \"Standard\",\n        tone: tone || \"professional\"\n      }, {\n        timeout: 10000\n      });\n      console.log(\"âœ… External AI service response received\");\n      return res.json(aiResponse.data);\n    } catch (externalError) {\n      console.log(\"ðŸ”§ External AI service unavailable, using internal generator\");\n      // Use our internal generator\n      const generatedContent = await generateArticleContent(topic, type, tone);\n      return res.json({\n        success: true,\n        generated_content: generatedContent,\n        source: \"internal_generator\"\n      });\n    }\n  } catch (error) {\n    console.error(\"âŒ Error generating article content:\", error.message);\n    res.status(500).json({\n      error: \"Erreur lors de la gÃ©nÃ©ration du contenu: \" + error.message\n    });\n  }\n});\n\n// Predict Event Attendance\napp.post(\"/ai/predict-attendance\", async (req, res) => {\n  try {\n    const {\n      eventDetails,\n      historicalData\n    } = req.body;\n    if (!eventDetails) {\n      return res.status(400).json({\n        error: \"Les dÃ©tails de l'Ã©vÃ©nement sont requis\"\n      });\n    }\n    console.log(\"ðŸ¤– Predicting attendance for:\", eventDetails);\n    try {\n      // Try external AI service first\n      const aiResponse = await axios.post('http://localhost:5001/ai/predict-attendance', {\n        eventDetails,\n        historicalData: historicalData || []\n      }, {\n        timeout: 10000\n      });\n      console.log(\"âœ… External AI service response received\");\n      return res.json(aiResponse.data);\n    } catch (externalError) {\n      console.log(\"ðŸ”§ External AI service unavailable, using internal predictor\");\n      // Use our internal predictor\n      const prediction = await predictAttendance(eventDetails, historicalData);\n      return res.json({\n        success: true,\n        prediction: prediction,\n        source: \"internal_predictor\"\n      });\n    }\n  } catch (error) {\n    console.error(\"âŒ Error predicting attendance:\", error.message);\n    res.status(500).json({\n      error: \"Erreur lors de la prÃ©diction de participation: \" + error.message\n    });\n  }\n});\n\n// Batch Predict Attendance for All Events\napp.get(\"/ai/predict-all-attendance\", async (req, res) => {\n  try {\n    // For now, using mock data - you can replace this with actual SPARQL query\n    const mockEvents = [{\n      id: 'event1',\n      title: 'ConfÃ©rence SantÃ© Digitale',\n      location: 'Paris',\n      status: 'PlanifiÃ©',\n      startDate: '2024-01-15'\n    }, {\n      id: 'event2',\n      title: 'Workshop Innovation',\n      location: 'Lyon',\n      status: 'En cours',\n      startDate: '2024-01-10'\n    }, {\n      id: 'event3',\n      title: 'SÃ©minaire MÃ©dical',\n      location: 'Marseille',\n      status: 'TerminÃ©',\n      startDate: '2024-01-05'\n    }];\n    console.log(\"\\uD83E\\uDD16 Predicting attendance for \".concat(mockEvents.length, \" events\"));\n\n    // Predict attendance for each event\n    const predictions = await Promise.all(mockEvents.map(async event => {\n      try {\n        const prediction = await predictAttendance(event);\n        return {\n          event: event,\n          prediction: prediction\n        };\n      } catch (error) {\n        console.error(\"\\u274C Error predicting for event \".concat(event.id, \":\"), error);\n        return {\n          event: event,\n          prediction: null,\n          error: error.message\n        };\n      }\n    }));\n\n    // Calculate overall statistics\n    const successfulPredictions = predictions.filter(p => p.prediction);\n    const totalPredictedAttendance = successfulPredictions.reduce((sum, p) => sum + p.prediction.predictedAttendance, 0);\n    const avgAttendance = successfulPredictions.length > 0 ? Math.round(totalPredictedAttendance / successfulPredictions.length) : 0;\n    res.json({\n      success: true,\n      total_events: mockEvents.length,\n      predictions: predictions,\n      statistics: {\n        average_attendance: avgAttendance,\n        total_predicted_attendance: totalPredictedAttendance,\n        successful_predictions: successfulPredictions.length,\n        failed_predictions: predictions.length - successfulPredictions.length\n      }\n    });\n  } catch (error) {\n    console.error(\"âŒ Error in batch attendance prediction:\", error.message);\n    res.status(500).json({\n      error: \"Erreur lors de la prÃ©diction groupÃ©e: \" + error.message,\n      success: false\n    });\n  }\n});\n\n// Enhanced AI Processing endpoint with new capabilities\napp.post(\"/ai/process-evenements\", async (req, res) => {\n  try {\n    const {\n      question,\n      context\n    } = req.body;\n    if (!question) {\n      return res.status(400).json({\n        error: \"Question is required\"\n      });\n    }\n    console.log(\"ðŸ¤– Processing AI question:\", question);\n    console.log(\"ðŸ“Š Context received:\", context);\n    try {\n      const aiResponse = await axios.post('http://localhost:5001/ai/process', {\n        question,\n        context\n      }, {\n        timeout: 5000\n      });\n      console.log(\"âœ… External AI service response:\", aiResponse.data);\n      return res.json(aiResponse.data);\n    } catch (externalError) {\n      console.log(\"ðŸ”§ External AI service unavailable, using enhanced mock service\");\n      const mockResponse = mockAIResponse(question, context);\n      console.log(\"ðŸ”§ Enhanced mock AI response:\", mockResponse);\n      return res.json(mockResponse);\n    }\n  } catch (error) {\n    console.error(\"âŒ AI Processing Error:\", error.message);\n    const fallbackResponse = {\n      action: 'read',\n      natural_response: \"Je vais afficher les \\xE9l\\xE9ments correspondant \\xE0 \\\"\".concat(req.body.question, \"\\\"\"),\n      filters: [{\n        field: 'aTitle',\n        operator: 'contains',\n        value: req.body.question,\n        description: \"Recherche: \\\"\".concat(req.body.question, \"\\\"\")\n      }],\n      confidence: 0.5\n    };\n    res.json(fallbackResponse);\n  }\n});\n\n// Enhanced Statistics endpoint\napp.get(\"/ai/stats/evenements\", async (req, res) => {\n  try {\n    // Mock stats for now - you can replace with actual SPARQL queries\n    const mockStats = {\n      status: [{\n        status: \"PlanifiÃ©\",\n        count: 5\n      }, {\n        status: \"En cours\",\n        count: 3\n      }, {\n        status: \"TerminÃ©\",\n        count: 8\n      }, {\n        status: \"AnnulÃ©\",\n        count: 1\n      }],\n      monthly: [{\n        month: 1,\n        count: 4\n      }, {\n        month: 2,\n        count: 3\n      }, {\n        month: 3,\n        count: 5\n      }],\n      total: 17\n    };\n    res.json(mockStats);\n  } catch (error) {\n    console.error(\"âŒ Error fetching statistics:\", error.message);\n    res.status(500).json({\n      error: error.message,\n      status: [],\n      monthly: [],\n      total: 0\n    });\n  }\n});\n\n// âœ… Health check\napp.get(\"/\", (req, res) => {\n  res.json({\n    message: \"Backend API is running âœ…\",\n    ai_endpoints: [\"POST /ai/generate-article-content\", \"POST /ai/predict-attendance\", \"GET /ai/predict-all-attendance\", \"POST /ai/process-evenements\", \"GET /ai/stats/evenements\"]\n  });\n});\n\n// âœ… Start server\nconst PORT = process.env.PORT || 5000;\napp.listen(PORT, () => console.log(\"\\uD83D\\uDE80 Backend running at: http://localhost:\".concat(PORT)));","map":{"version":3,"names":["require","config","express","cors","bodyParser","axios","authRoutes","healthProgramRoutes","evenementRoutes","articleRoutes","aiRoutes","aiarticleRoutes","aienhancedRoutes","app","use","json","generateArticleContent","topic","type","arguments","length","undefined","tone","console","log","concat","titles","descriptions","title","description","content","generated_at","Date","toISOString","word_count","Math","floor","random","error","Error","predictAttendance","eventDetails","historicalData","basePrediction","factors","locationMultipliers","location","push","statusMultipliers","status","currentMonth","getMonth","seasonMultipliers","avgHistorical","reduce","sum","event","attendance","historicalAdjustment","randomVariation","max","min","round","confidence","predictedAttendance","parseFloat","toFixed","prediction_date","recommendation","mockAIResponse","question","context","lowerQuestion","toLowerCase","currentEvents","totalEvents","currentArticles","totalArticles","includes","topicMatch","match","trim","action","natural_response","data","analyze_all","plannedEvents","filter","e","filters","field","operator","value","ongoingEvents","completedEvents","cancelledEvents","locations","foundLocation","find","loc","locationEvents","charAt","toUpperCase","slice","aTitle","extractTitle","aLocalisation","extractLocation","psStatus","psDateDebut","split","psDateFin","now","psDescription","extractDescription","extractSearchTerm","matches","found","substring","stopWords","words","word","join","post","req","res","body","aiResponse","timeout","externalError","generatedContent","success","generated_content","source","message","prediction","get","mockEvents","id","startDate","predictions","Promise","all","map","successfulPredictions","p","totalPredictedAttendance","avgAttendance","total_events","statistics","average_attendance","total_predicted_attendance","successful_predictions","failed_predictions","mockResponse","fallbackResponse","mockStats","count","monthly","month","total","ai_endpoints","PORT","process","env","listen"],"sources":["C:/Users/K/Documents/W/WS_SmartHealth/client/src/views/examples/Evenement.jsx"],"sourcesContent":[" require(\"dotenv\").config();\nconst express = require(\"express\");\nconst cors = require(\"cors\");\nconst bodyParser = require(\"body-parser\");\nconst axios = require(\"axios\");\n\nconst authRoutes = require(\"./routes/auth\");\nconst healthProgramRoutes = require(\"./routes/healthPrograms\");\nconst evenementRoutes = require(\"./routes/evenementRoutes\"); \nconst articleRoutes = require(\"./routes/articleRoutes\"); \nconst aiRoutes = require(\"./routes/aiRoutes\"); \nconst aiarticleRoutes = require(\"./routes/ai-articles\"); \nconst aienhancedRoutes = require(\"./routes/ai-enhanced\"); \n\nconst app = express();\n\n// âœ… Middleware\napp.use(cors());\napp.use(bodyParser.json());\n\n// âœ… Routes\napp.use(\"/api/auth\", authRoutes);\napp.use(\"/api/health-programs\", healthProgramRoutes);\napp.use(\"/api/evenements\", evenementRoutes);\napp.use(\"/api/articles\", articleRoutes);\napp.use(\"/ai\", aiRoutes);\napp.use(\"/aiarticle\", aiarticleRoutes);\napp.use(\"/aienhanced\", aienhancedRoutes);\n\n// âœ… AI Content Generation Function\nconst generateArticleContent = async (topic, type = \"Standard\", tone = \"professional\") => {\n  try {\n    console.log(`ðŸ¤– Generating content for topic: ${topic}, type: ${type}, tone: ${tone}`);\n    \n    const titles = {\n      \"Premium\": `Analyse Exclusive: ${topic} - Perspectives AvancÃ©es`,\n      \"Standard\": `Ã‰tude Approfondie: ${topic} - Tendances et Analyses`,\n      \"Basique\": `Guide Pratique: Comprendre ${topic}`\n    };\n\n    const descriptions = {\n      \"Premium\": `Article premium gÃ©nÃ©rÃ© automatiquement offrant une analyse complÃ¨te de \"${topic}\" avec insights exclusifs et donnÃ©es rÃ©centes.`,\n      \"Standard\": `Contenu gÃ©nÃ©rÃ© automatiquement explorant les aspects clÃ©s de \"${topic}\" avec analyse structurÃ©e et recommandations.`,\n      \"Basique\": `Introduction claire et concise sur \"${topic}\" gÃ©nÃ©rÃ©e automatiquement pour une comprÃ©hension rapide.`\n    };\n\n    return {\n      title: titles[type] || titles[\"Standard\"],\n      description: descriptions[type] || descriptions[\"Standard\"],\n      content: `# ${topic}\\n\\n## Introduction\\nCet article a Ã©tÃ© gÃ©nÃ©rÃ© automatiquement pour explorer le thÃ¨me \"${topic}\".\\n\\n## Points ClÃ©s\\n- Aspect important 1\\n- Aspect important 2  \\n- Perspective future\\n\\n## Conclusion\\nAnalyse synthÃ©tique gÃ©nÃ©rÃ©e par IA.`,\n      generated_at: new Date().toISOString(),\n      word_count: Math.floor(Math.random() * 200) + 300\n    };\n  } catch (error) {\n    console.error(\"âŒ Error generating article content:\", error);\n    throw new Error(\"Erreur lors de la gÃ©nÃ©ration du contenu\");\n  }\n};\n\n// âœ… AI Event Attendance Prediction Function\nconst predictAttendance = async (eventDetails, historicalData = []) => {\n  try {\n    console.log(\"ðŸ¤– Predicting attendance for event:\", eventDetails);\n    \n    let basePrediction = 100;\n    const factors = [];\n    \n    const locationMultipliers = {\n      'Paris': 1.5, 'Lyon': 1.2, 'Marseille': 1.1,\n      'Londres': 1.4, 'New York': 1.6, 'Tokyo': 1.3\n    };\n    \n    if (eventDetails.location && locationMultipliers[eventDetails.location]) {\n      basePrediction *= locationMultipliers[eventDetails.location];\n      factors.push(`Localisation: ${eventDetails.location}`);\n    }\n    \n    const statusMultipliers = {\n      'PlanifiÃ©': 1.0, 'En cours': 1.2, 'TerminÃ©': 0.8, 'AnnulÃ©': 0.1\n    };\n    \n    if (eventDetails.status && statusMultipliers[eventDetails.status]) {\n      basePrediction *= statusMultipliers[eventDetails.status];\n      factors.push(`Statut: ${eventDetails.status}`);\n    }\n    \n    const currentMonth = new Date().getMonth() + 1;\n    const seasonMultipliers = {\n      12: 1.3, 1: 1.1, 6: 1.2, 9: 1.4\n    };\n    \n    if (seasonMultipliers[currentMonth]) {\n      basePrediction *= seasonMultipliers[currentMonth];\n      factors.push(`Saison: Mois ${currentMonth}`);\n    }\n    \n    if (historicalData.length > 0) {\n      const avgHistorical = historicalData.reduce((sum, event) => sum + event.attendance, 0) / historicalData.length;\n      const historicalAdjustment = avgHistorical / 100;\n      basePrediction = (basePrediction + historicalAdjustment * 50) / 2;\n      factors.push(`DonnÃ©es historiques: ${historicalData.length} Ã©vÃ©nements`);\n    }\n    \n    const randomVariation = Math.random() * 40 - 20;\n    basePrediction *= (1 + randomVariation / 100);\n    \n    basePrediction = Math.max(10, Math.min(500, Math.round(basePrediction)));\n    \n    let confidence = 0.7;\n    if (historicalData.length > 5) confidence += 0.2;\n    if (eventDetails.location && eventDetails.status) confidence += 0.1;\n    confidence = Math.min(0.95, confidence);\n    \n    return {\n      predictedAttendance: Math.round(basePrediction),\n      confidence: parseFloat(confidence.toFixed(2)),\n      factors: factors.length > 0 ? factors : [\"DonnÃ©es de base\"],\n      prediction_date: new Date().toISOString(),\n      recommendation: basePrediction > 200 ? \"Ã‰vÃ©nement Ã  fort potentiel\" : \"Participation standard attendue\"\n    };\n  } catch (error) {\n    console.error(\"âŒ Error predicting attendance:\", error);\n    throw new Error(\"Erreur lors de la prÃ©diction de participation\");\n  }\n};\n\n// âœ… Enhanced Mock AI service\nconst mockAIResponse = (question, context = {}) => {\n  const lowerQuestion = question.toLowerCase();\n  const { currentEvents = [], totalEvents = 0, currentArticles = [], totalArticles = 0 } = context;\n  \n  // Article Content Generation\n  if (lowerQuestion.includes('gÃ©nÃ©rer') && (lowerQuestion.includes('article') || lowerQuestion.includes('contenu'))) {\n    const topicMatch = question.match(/(?:article|contenu|gÃ©nÃ©rer)\\s+(?:sur|about|de)\\s+([^,.!?]+)/i);\n    const topic = topicMatch ? topicMatch[1].trim() : 'technologie';\n    \n    return {\n      action: 'generate_content',\n      natural_response: `Je vais gÃ©nÃ©rer un article automatiquement sur le thÃ¨me \"${topic}\".`,\n      data: {\n        topic: topic,\n        type: 'Standard',\n        tone: 'professional'\n      },\n      confidence: 0.9\n    };\n  }\n  \n  // Attendance Prediction\n  if ((lowerQuestion.includes('participation') || lowerQuestion.includes('attendance') || lowerQuestion.includes('frÃ©quentation')) && \n      (lowerQuestion.includes('prÃ©dire') || lowerQuestion.includes('predict') || lowerQuestion.includes('estimer'))) {\n    return {\n      action: 'predict_attendance',\n      natural_response: \"Je vais analyser et prÃ©dire la participation aux Ã©vÃ©nements.\",\n      data: {\n        analyze_all: true\n      },\n      confidence: 0.8\n    };\n  }\n  \n  // Existing event status queries...\n  if (lowerQuestion.includes('planifiÃ©') || lowerQuestion.includes('planifie')) {\n    const plannedEvents = currentEvents.filter(e => e.status === 'PlanifiÃ©');\n    return {\n      action: 'read',\n      natural_response: `J'ai trouvÃ© ${plannedEvents.length} Ã©vÃ©nement(s) planifiÃ©(s) sur ${totalEvents} au total.`,\n      filters: [\n        { field: 'psStatus', operator: '==', value: 'PlanifiÃ©', description: 'Statut: PlanifiÃ©' }\n      ],\n      confidence: 0.9\n    };\n  }\n  \n  if (lowerQuestion.includes('en cours')) {\n    const ongoingEvents = currentEvents.filter(e => e.status === 'En cours');\n    return {\n      action: 'read',\n      natural_response: `J'ai trouvÃ© ${ongoingEvents.length} Ã©vÃ©nement(s) en cours sur ${totalEvents} au total.`,\n      filters: [\n        { field: 'psStatus', operator: '==', value: 'En cours', description: 'Statut: En cours' }\n      ],\n      confidence: 0.9\n    };\n  }\n  \n  if (lowerQuestion.includes('terminÃ©') || lowerQuestion.includes('termine')) {\n    const completedEvents = currentEvents.filter(e => e.status === 'TerminÃ©');\n    return {\n      action: 'read',\n      natural_response: `J'ai trouvÃ© ${completedEvents.length} Ã©vÃ©nement(s) terminÃ©(s) sur ${totalEvents} au total.`,\n      filters: [\n        { field: 'psStatus', operator: '==', value: 'TerminÃ©', description: 'Statut: TerminÃ©' }\n      ],\n      confidence: 0.9\n    };\n  }\n  \n  if (lowerQuestion.includes('annulÃ©') || lowerQuestion.includes('annule')) {\n    const cancelledEvents = currentEvents.filter(e => e.status === 'AnnulÃ©');\n    return {\n      action: 'read',\n      natural_response: `J'ai trouvÃ© ${cancelledEvents.length} Ã©vÃ©nement(s) annulÃ©(s) sur ${totalEvents} au total.`,\n      filters: [\n        { field: 'psStatus', operator: '==', value: 'AnnulÃ©', description: 'Statut: AnnulÃ©' }\n      ],\n      confidence: 0.9\n    };\n  }\n  \n  // Location-based queries\n  const locations = ['paris', 'lyon', 'marseille', 'toulouse', 'londres', 'new york', 'tokyo'];\n  const foundLocation = locations.find(loc => lowerQuestion.includes(loc));\n  if (foundLocation) {\n    const locationEvents = currentEvents.filter(e => \n      e.location && e.location.toLowerCase().includes(foundLocation)\n    );\n    return {\n      action: 'read',\n      natural_response: `J'ai trouvÃ© ${locationEvents.length} Ã©vÃ©nement(s) Ã  ${foundLocation.charAt(0).toUpperCase() + foundLocation.slice(1)}.`,\n      filters: [\n        { field: 'aLocalisation', operator: 'contains', value: foundLocation, description: `Localisation: ${foundLocation}` }\n      ],\n      confidence: 0.8\n    };\n  }\n  \n  // Creation\n  if (lowerQuestion.includes('ajout') || lowerQuestion.includes('crÃ©') || lowerQuestion.includes('nouveau') || lowerQuestion.includes('add')) {\n    return {\n      action: 'create',\n      natural_response: `J'ai dÃ©tectÃ© que vous voulez crÃ©er un nouvel Ã©vÃ©nement. Je vais le faire automatiquement!`,\n      data: {\n        aTitle: extractTitle(question),\n        aLocalisation: extractLocation(question),\n        psStatus: 'PlanifiÃ©',\n        psDateDebut: new Date().toISOString().split('T')[0],\n        psDateFin: new Date(Date.now() + 86400000).toISOString().split('T')[0],\n        psDescription: extractDescription(question)\n      },\n      confidence: 0.9\n    };\n  }\n  \n  // Default search\n  return {\n    action: 'read',\n    natural_response: `Voici les Ã©lÃ©ments correspondant Ã  votre recherche.`,\n    filters: [\n      { field: 'aTitle', operator: 'contains', value: extractSearchTerm(question), description: `Recherche: \"${extractSearchTerm(question)}\"` }\n    ],\n    confidence: 0.6\n  };\n};\n\n// Helper functions\nconst extractTitle = (question) => {\n  const matches = question.match(/(?:Ã©vÃ©nement|event|meeting|rÃ©union|confÃ©rence)\\s+([^,.!?]+)/i);\n  return matches ? matches[1].trim() : 'Nouvel Ã‰vÃ©nement';\n};\n\nconst extractLocation = (question) => {\n  const locations = ['paris', 'lyon', 'marseille', 'toulouse', 'londres', 'new york', 'tokyo'];\n  const found = locations.find(loc => question.toLowerCase().includes(loc));\n  return found ? found.charAt(0).toUpperCase() + found.slice(1) : 'Non spÃ©cifiÃ©';\n};\n\nconst extractDescription = (question) => {\n  return `Ã‰vÃ©nement crÃ©Ã© via commande vocale: \"${question.substring(0, 100)}\"`;\n};\n\nconst extractSearchTerm = (question) => {\n  const stopWords = ['affiche', 'montre', 'cherche', 'trouve', 'liste', 'vois', 'donne', 'les', 'des', 'Ã©vÃ©nements', 'events', 'articles'];\n  const words = question.toLowerCase().split(' ');\n  return words.filter(word => !stopWords.includes(word) && word.length > 2).join(' ') || question;\n};\n\n// âœ… NEW AI ENDPOINTS\n\n// Generate Article Content\napp.post(\"/ai/generate-article-content\", async (req, res) => {\n  try {\n    const { topic, type, tone } = req.body;\n    \n    if (!topic) {\n      return res.status(400).json({ error: \"Le sujet (topic) est requis\" });\n    }\n\n    console.log(\"ðŸ¤– Generating article content for:\", { topic, type, tone });\n\n    try {\n      // Try external AI service first\n      const aiResponse = await axios.post('http://localhost:5001/ai/generate-content', {\n        topic,\n        type: type || \"Standard\",\n        tone: tone || \"professional\"\n      }, {\n        timeout: 10000\n      });\n      \n      console.log(\"âœ… External AI service response received\");\n      return res.json(aiResponse.data);\n    } catch (externalError) {\n      console.log(\"ðŸ”§ External AI service unavailable, using internal generator\");\n      // Use our internal generator\n      const generatedContent = await generateArticleContent(topic, type, tone);\n      return res.json({\n        success: true,\n        generated_content: generatedContent,\n        source: \"internal_generator\"\n      });\n    }\n    \n  } catch (error) {\n    console.error(\"âŒ Error generating article content:\", error.message);\n    res.status(500).json({ \n      error: \"Erreur lors de la gÃ©nÃ©ration du contenu: \" + error.message \n    });\n  }\n});\n\n// Predict Event Attendance\napp.post(\"/ai/predict-attendance\", async (req, res) => {\n  try {\n    const { eventDetails, historicalData } = req.body;\n    \n    if (!eventDetails) {\n      return res.status(400).json({ error: \"Les dÃ©tails de l'Ã©vÃ©nement sont requis\" });\n    }\n\n    console.log(\"ðŸ¤– Predicting attendance for:\", eventDetails);\n\n    try {\n      // Try external AI service first\n      const aiResponse = await axios.post('http://localhost:5001/ai/predict-attendance', {\n        eventDetails,\n        historicalData: historicalData || []\n      }, {\n        timeout: 10000\n      });\n      \n      console.log(\"âœ… External AI service response received\");\n      return res.json(aiResponse.data);\n    } catch (externalError) {\n      console.log(\"ðŸ”§ External AI service unavailable, using internal predictor\");\n      // Use our internal predictor\n      const prediction = await predictAttendance(eventDetails, historicalData);\n      return res.json({\n        success: true,\n        prediction: prediction,\n        source: \"internal_predictor\"\n      });\n    }\n    \n  } catch (error) {\n    console.error(\"âŒ Error predicting attendance:\", error.message);\n    res.status(500).json({ \n      error: \"Erreur lors de la prÃ©diction de participation: \" + error.message \n    });\n  }\n});\n\n// Batch Predict Attendance for All Events\napp.get(\"/ai/predict-all-attendance\", async (req, res) => {\n  try {\n    // For now, using mock data - you can replace this with actual SPARQL query\n    const mockEvents = [\n      {\n        id: 'event1',\n        title: 'ConfÃ©rence SantÃ© Digitale',\n        location: 'Paris',\n        status: 'PlanifiÃ©',\n        startDate: '2024-01-15'\n      },\n      {\n        id: 'event2', \n        title: 'Workshop Innovation',\n        location: 'Lyon',\n        status: 'En cours',\n        startDate: '2024-01-10'\n      },\n      {\n        id: 'event3',\n        title: 'SÃ©minaire MÃ©dical',\n        location: 'Marseille',\n        status: 'TerminÃ©',\n        startDate: '2024-01-05'\n      }\n    ];\n\n    console.log(`ðŸ¤– Predicting attendance for ${mockEvents.length} events`);\n\n    // Predict attendance for each event\n    const predictions = await Promise.all(\n      mockEvents.map(async (event) => {\n        try {\n          const prediction = await predictAttendance(event);\n          return {\n            event: event,\n            prediction: prediction\n          };\n        } catch (error) {\n          console.error(`âŒ Error predicting for event ${event.id}:`, error);\n          return {\n            event: event,\n            prediction: null,\n            error: error.message\n          };\n        }\n      })\n    );\n\n    // Calculate overall statistics\n    const successfulPredictions = predictions.filter(p => p.prediction);\n    const totalPredictedAttendance = successfulPredictions.reduce((sum, p) => sum + p.prediction.predictedAttendance, 0);\n    const avgAttendance = successfulPredictions.length > 0 ? Math.round(totalPredictedAttendance / successfulPredictions.length) : 0;\n\n    res.json({\n      success: true,\n      total_events: mockEvents.length,\n      predictions: predictions,\n      statistics: {\n        average_attendance: avgAttendance,\n        total_predicted_attendance: totalPredictedAttendance,\n        successful_predictions: successfulPredictions.length,\n        failed_predictions: predictions.length - successfulPredictions.length\n      }\n    });\n\n  } catch (error) {\n    console.error(\"âŒ Error in batch attendance prediction:\", error.message);\n    res.status(500).json({ \n      error: \"Erreur lors de la prÃ©diction groupÃ©e: \" + error.message,\n      success: false\n    });\n  }\n});\n\n// Enhanced AI Processing endpoint with new capabilities\napp.post(\"/ai/process-evenements\", async (req, res) => {\n  try {\n    const { question, context } = req.body;\n    \n    if (!question) {\n      return res.status(400).json({ error: \"Question is required\" });\n    }\n\n    console.log(\"ðŸ¤– Processing AI question:\", question);\n    console.log(\"ðŸ“Š Context received:\", context);\n\n    try {\n      const aiResponse = await axios.post('http://localhost:5001/ai/process', {\n        question,\n        context\n      }, {\n        timeout: 5000\n      });\n      \n      console.log(\"âœ… External AI service response:\", aiResponse.data);\n      return res.json(aiResponse.data);\n    } catch (externalError) {\n      console.log(\"ðŸ”§ External AI service unavailable, using enhanced mock service\");\n      const mockResponse = mockAIResponse(question, context);\n      console.log(\"ðŸ”§ Enhanced mock AI response:\", mockResponse);\n      return res.json(mockResponse);\n    }\n    \n  } catch (error) {\n    console.error(\"âŒ AI Processing Error:\", error.message);\n    \n    const fallbackResponse = {\n      action: 'read',\n      natural_response: `Je vais afficher les Ã©lÃ©ments correspondant Ã  \"${req.body.question}\"`,\n      filters: [\n        { field: 'aTitle', operator: 'contains', value: req.body.question, description: `Recherche: \"${req.body.question}\"` }\n      ],\n      confidence: 0.5\n    };\n    \n    res.json(fallbackResponse);\n  }\n});\n\n// Enhanced Statistics endpoint\napp.get(\"/ai/stats/evenements\", async (req, res) => {\n  try {\n    // Mock stats for now - you can replace with actual SPARQL queries\n    const mockStats = {\n      status: [\n        { status: \"PlanifiÃ©\", count: 5 },\n        { status: \"En cours\", count: 3 },\n        { status: \"TerminÃ©\", count: 8 },\n        { status: \"AnnulÃ©\", count: 1 }\n      ],\n      monthly: [\n        { month: 1, count: 4 },\n        { month: 2, count: 3 },\n        { month: 3, count: 5 }\n      ],\n      total: 17\n    };\n\n    res.json(mockStats);\n\n  } catch (error) {\n    console.error(\"âŒ Error fetching statistics:\", error.message);\n    res.status(500).json({ \n      error: error.message,\n      status: [],\n      monthly: [],\n      total: 0\n    });\n  }\n});\n\n// âœ… Health check\napp.get(\"/\", (req, res) => {\n  res.json({ \n    message: \"Backend API is running âœ…\",\n    ai_endpoints: [\n      \"POST /ai/generate-article-content\",\n      \"POST /ai/predict-attendance\", \n      \"GET /ai/predict-all-attendance\",\n      \"POST /ai/process-evenements\",\n      \"GET /ai/stats/evenements\"\n    ]\n  });\n});\n\n// âœ… Start server\nconst PORT = process.env.PORT || 5000;\napp.listen(PORT, () =>\n  console.log(`ðŸš€ Backend running at: http://localhost:${PORT}`)\n);"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}